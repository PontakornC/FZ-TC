<div class="container" ngSkipHydration>
  <h1>{{ title }} - คำนวณ OVR นักเตะ</h1>
  
  <!-- Position Selection -->
  <div class="position-selector">
    <h2>เลือกตำแหน่ง:</h2>
    <div class="position-buttons">
      <button 
        *ngFor="let pos of positions" 
        (click)="selectPosition(pos)"
        [class.active]="selectedPosition === pos"
        class="position-btn">
        {{ pos.name }}
      </button>
    </div>
  </div>

  <!-- Selected Position Stats Table -->
  <div *ngIf="selectedPosition" class="position-stats">
    <div class="position-header">
      <h3>{{ selectedPosition.name }}</h3>
      <div class="ovr-display">OVR: <span class="ovr-value">{{ calculateOVR(selectedPosition) }}</span></div>
    </div>
    
    <table class="stats-table">
      <thead>
        <tr>
          <th>สเตตัส</th>
          <th>น้ำหนัก (%)</th>
          <th>ค่าพลัง</th>
          <th>อัพเกรด</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let stat of selectedPosition.stats; let i = index" [class.even]="i % 2 === 0">
          <td class="stat-name">{{ stat.name }}</td>
          <td class="weight">{{ stat.weight }}%</td>
          <td class="input-cell">
            <input 
              type="number" 
              [(ngModel)]="stat.value" 
              (input)="calculateOVR(selectedPosition!)" 
              (keydown)="handleKeyDown($event, i)" 
              #statInput
              placeholder=""
              class="stat-input"
            />
          </td>
          <td class="upgrade">
            <button type="button" class="upgrade-btn minus" (click)="upgradeDown(stat)">
              <i class="fa fa-minus"></i>
            </button>
            <span class="upgrade-value">{{ stat.upgrade }}</span>
            <button type="button" class="upgrade-btn plus" (click)="upgradeUp(stat)">
              <i class="fa fa-plus"></i>
            </button>
          </td>
        </tr>
      </tbody>
      <tfoot>
        <tr class="total-row">
          <td colspan="3" class="total-label">รวม OVR</td>
          <td class="total-ovr">{{ calculateOVR(selectedPosition) }}</td>
        </tr>
      </tfoot>
    </table>
  </div>

  <div *ngIf="!selectedPosition" class="no-selection">
    <p>กรุณาเลือกตำแหน่งที่ต้องการคำนวณ OVR</p>
  </div>
</div>

<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
/>